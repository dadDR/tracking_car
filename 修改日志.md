# 朱嘉祺 项目修改日志（Update at 2024.9.20）
- 在开发项目的过程中，发现参考项目remotecontroller 中使用的框架不是widget ，而是QGraphicsScene ， 再经过上网查找资料和翻文档后发现，QGraphicsScene提供了一个独立于窗口的坐标系统，可以自定义场景的大小和坐标范围，不受窗口的影响。这样子就可以将小车放置在任意坐标位置，而无需考虑窗口的尺寸或布局（主要是无需坐标系统？）会比Widget方便很多
- 遇到的问题：小车在移植后，将摄像头的拍摄范围绑定在小车上，然而在移动小车时，摄像头范围虽然会跟着移动，但是却会留下残影，初步判断是因为摄像头范围的刷新调用不正确 
- 之后发现是小车的边界矩形没有修改，导致摄像头的部分范围没有在边界矩形中,因此没在边界矩形中的那部分摄像头范围没有正确定义，故会导致摄像头框线内部的颜色部分在拖动小车时并没有随着小车的移动一起刷新。
- 图层问题：在绘制完成后发现赛道的图层在小车之上，(2024.9.13)；解决方案：调整图层
- 检测图像问题：程序都写好后，发现虚拟摄像头无法检测到赛道，因此进行了程序上的调试，首先编写一个调试程序，看看虚拟摄像头检测框是否检测到了黑色的像素，在调试过程中为了提高效率，将摄像头的检测范围扩大(2024.9.14)
- 发现问题：我目前是使用ssh远程连接RK3588进行代码运行和调试工作，在此过程中，我发现运行程序后远程显示的图像有时候是错误的。解决方案：本地调试(2024.9.14)
- 发现摄像头视角的问题：绘制区域的原点设置错误
- 显示摄像头和小车指令文字的窗口，使用一个自定义的QWidget类来实现
- 在创建新的widget后，想在其中显示摄像头图像和小车的指令，但是在调用的时候却出现段错误，具体相关代码在car.cpp中的
- imageLabelWidget->setImage(image); imageLabelWidget->setText(commandText);
- （Update at 9.20）
- 解决摄像头绘图框（红色的框）：运动的和小车不同步的问题：原因：之前摄像头绘图框是基于carPos().x 和 carPos().y 计算出来的 ， 这样会导致红色框坐标的计算是基于小车的绝对坐标系的，它的分度值和视图的坐标系不同，所以会导致运动不同步
- 一个很奇怪的bug:在将摄像头范围和小车坐标绑定后（就是参照小车的坐标给出摄像头的坐标），发现摄像头的识别图像始终停留在最初摄像头获取的第一个图像的地方，之后发现是代码image.fill(Qt::transparent);造成的问题：它把被渲染的图像填充成透明，导致图像分析结果只能读取到第一张图像的内容，其它图像被透明化了（似乎是这样），现在已经修改为image.fill(Qt::white);解决了问题
- 下一步：摄像头识别黑线的算法的识别有点问题，认为是摄像头本身的范围和对黑色像素差值的定义不对（待解决）
- 21号将把控制小车运动的控件加上，测试小车运动功能,之后再解决自动巡线程序的实现，然后将摄像头黑线识别算法的问题解决
- (Update at 2024.9.22)
- 在添加方向按键给小车后，编译程序出现了总线错误的问题：原因：目前未找到，可以知道，出现问题的地方就是在连接信号槽的地方，但是目前一直找不到确切的原因，使用gdb调试得到了堆栈显示它在 libQt5Core.so.5 库中发生错误，目前下一步计划直接在car.cpp中创建这四个按钮，不把它分出另一个页面避免时间的浪费(Update at 2024.9.22)（其中新建窗口的相关文件放置在了controlWindwos.cpp 和 .h 文件中）
- 在QGraphicsObject下创建了一组按键，虽然目前的效果很烂，但是至少按动按键后小车能动


